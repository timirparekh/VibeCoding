@model VibeCoding.Models.FinalReport
@{
    ViewData["Title"] = "Home Page";
}

<style>
    body {
        background: #f6f8fa;
    }
    .chat-box {
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.08);
        max-width: 800px;
        margin: 60px auto;
        padding: 32px 28px 24px 28px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .chat-box h2 {
        font-size: 2rem;
        font-weight: 600;
        margin-bottom: 12px;
        color: #1b6ec2;
    }
    .chat-box p {
        color: #444;
        font-size: 1.1rem;
        margin-bottom: 24px;
        text-align: left;
    }
    .file-upload {
        width: 100%;
        margin-bottom: 18px;
    }
    .submit-btn {
        width: 100%;
        background: #1b6ec2;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 12px;
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.2s;
    }
    .submit-btn:hover {
        background: #155a9c;
    }
</style>

<div class="chat-box">
    <h2>Upload Your Document</h2>
    <p>
        To get an audit summary, please upload your document using the form below.<br>
        After uploading, click Submit to process your file.
    </p>
    <form method="post" enctype="multipart/form-data" style="width:100%" action="/Home/UploadFile" id="uploadForm">
        <div class="mb-3 w-100">
            <input class="form-control" type="file" id="uploadedFile" name="uploadedFile" accept=".docx"
                required />
        </div>
        <button class="submit-btn" id="submitBtn" type="submit">Submit</button>
    </form>

    @if (ViewBag.UploadMessage != null)
    {
        <div id="uploadMessageBox"
            style="margin-top:20px; background:#e6ffed; color:#155724; border-radius:8px; padding:16px; text-align:center;">
            @ViewBag.UploadMessage
        </div>
    }

    @if (Model != null && !Model.IsInitialLoad)
    {
        <div id="docxContentSection"
            style="margin-top:24px; background:#f0f7ff; color:#222; border-radius:12px; padding:20px; text-align:left; min-height:80px; width:100%;">
            <h3 style="color:#1b6ec2; font-size:1.2rem; margin-bottom:10px;">Document Summary</h3>
            <ul style="list-style:none; padding-left:0;">
                @if (!string.IsNullOrWhiteSpace(Model.Client)) {
                    <li><strong>Client:</strong> @Model.Client</li>
                }
                @if (!string.IsNullOrWhiteSpace(Model.AuditType)) {
                    <li><strong>Audit Type:</strong> @Model.AuditType</li>
                }
                @if (!string.IsNullOrWhiteSpace(Model.AuditPeriod)) {
                    <li><strong>Audit Period:</strong> @Model.AuditPeriod</li>
                }
                @if (!string.IsNullOrWhiteSpace(Model.AuditTeamLead)) {
                    <li><strong>Audit Team Lead:</strong> @Model.AuditTeamLead</li>
                }
                @if (!string.IsNullOrWhiteSpace(Model.AuditManager)) {
                    <li><strong>Audit Manager:</strong> @Model.AuditManager</li>
                }
                @if (Model.EngagementAndOnboarding != null && Model.EngagementAndOnboarding.Any()) {
                    <li><strong>Engagement &amp; Onboarding:</strong>
                        <ul>
                        @foreach (var item in Model.EngagementAndOnboarding) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.AuditPlanning != null && Model.AuditPlanning.Any()) {
                    <li><strong>Audit Planning:</strong>
                        <ul>
                        @foreach (var item in Model.AuditPlanning) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.FieldworkExecution != null && Model.FieldworkExecution.Any()) {
                    <li><strong>Fieldwork Execution:</strong>
                        <ul>
                        @foreach (var item in Model.FieldworkExecution) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.Reporting != null && Model.Reporting.Any()) {
                    <li><strong>Reporting:</strong>
                        <ul>
                        @foreach (var item in Model.Reporting) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.ComplianceAndConfidentiality != null && Model.ComplianceAndConfidentiality.Any()) {
                    <li><strong>Compliance and Confidentiality:</strong>
                        <ul>
                        @foreach (var item in Model.ComplianceAndConfidentiality) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.PostAuditReview != null && Model.PostAuditReview.Any()) {
                    <li><strong>Post-Audit Review:</strong>
                        <ul>
                        @foreach (var item in Model.PostAuditReview) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.Attachments != null && Model.Attachments.Any()) {
                    <li><strong>Attachments:</strong>
                        <ul>
                        @foreach (var item in Model.Attachments) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.FollowUp != null && Model.FollowUp.Any()) {
                    <li><strong>Follow up:</strong>
                        <ul>
                        @foreach (var item in Model.FollowUp) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
                @if (Model.MajorObservations != null && Model.MajorObservations.Any()) {
                    <li><strong>Any major observations:</strong>
                        <ul>
                        @foreach (var item in Model.MajorObservations) {
                            <li>@item</li>
                        }
                        </ul>
                    </li>
                }
            </ul>
        </div>
    }
    <script>
    document.addEventListener('DOMContentLoaded', function() {
            var form = document.getElementById('uploadForm');
            var submitBtn = document.getElementById('submitBtn');
            var messageBox = document.getElementById('uploadMessageBox');

        form.addEventListener('submit', function() {
                submitBtn.disabled = true;
                submitBtn.style.background = '#b0b0b0';
            });

            // Show message if present from server
            var msg = '@TempData["UploadMessage"]';
            if (msg && msg !== '') {
                messageBox.textContent = msg;
                messageBox.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.style.background = '';
            }
        });
    </script>
</div>
